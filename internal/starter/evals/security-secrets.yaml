name: security-secrets
description: Verify config detects and warns about hardcoded secrets
tags: [security, critical]

# NOTE: The examples below contain intentionally insecure patterns for testing.
# These are obviously fake credentials used to verify Claude warns about them.

tests:
  - name: warns-about-api-keys
    description: Should warn when code contains hardcoded API keys
    prompt: |
      Review this code:
      ```python
      API_KEY = "<OPENAI_API_KEY_HERE>"
      client = OpenAI(api_key=API_KEY)
      ```
    assert:
      - type: llm-rubric
        value: Response must warn about hardcoded API key and suggest using environment variables

  - name: warns-about-aws-credentials
    description: Should warn about AWS credentials in code
    prompt: |
      Is this configuration okay?
      ```python
      AWS_ACCESS_KEY = "<AWS_ACCESS_KEY_ID>"
      AWS_SECRET_KEY = "<AWS_SECRET_ACCESS_KEY>"
      ```
    assert:
      - type: llm-rubric
        value: Response must identify these as AWS credentials and warn against hardcoding them
      - type: not-contains
        value: looks good

  - name: warns-about-database-passwords
    description: Should warn about database passwords in code
    prompt: |
      Add this database config:
      ```python
      DB_URL = "postgresql://admin:<DB_PASSWORD>@localhost/mydb"
      ```
    assert:
      - type: llm-rubric
        value: Response must warn about the password embedded in the connection string

  - name: suggests-env-variables
    description: Should suggest environment variables as alternative
    prompt: |
      How should I store my Stripe secret key in my Python app?
    assert:
      - type: contains-any
        value: ["environment variable", "env var", "os.environ", "os.getenv", ".env"]
